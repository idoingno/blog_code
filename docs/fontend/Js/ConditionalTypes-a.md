---
title: 条件类型
author: Q
autoGroup-3: Dom
date: "2021-12-12"
---

## Dom diff

通过`JS`层面的计算，返回一个 patch 对象，即补丁对象，在通过特定的操作解析`patch`对象，完成页面的重新渲染。

> 完全对比方案 时间复杂度为 O(n³)

关于 O(n³) 的由来。由于左树中任意节点都可能出现在右树，所以必须在对左树深度遍历的同时，对右树进行深度遍历，找到每个节点的对应关系，这里的时间复杂度是 O(n²)，之后需要对树的各节点进行增删移的操作，这个过程简单可以理解为加了一层遍历循环，因此再乘一个 n。

![](/imgs/0210302175705.jpg)

## Vue 的 Dom diff

同层比较 时间复杂度为 O(n)

1. 尽量保证不要发生 dom 位移, 左右夹击跳过不变的
2. 找到**最长连续子串**保持不动，移动其他元素

```javascript
// 动态规划，设 dp(i) 为以第 i 个字符串结尾的最长连续子串长度，一次 O(n) 循环即可。
dp(i) = num[i] > num[i - 1] ? dp(i - 1) + 1 : 1
```

## React 的 Dom diff

同层比较 时间复杂度为 O(n)

1. React 采用了 **仅右移策略**, 对元素发生的位置变化，只会将其移动到右边，那么右边移完了，其他位置也就有序了
2. 在大部分从左往右移的业务场景中，得到了较好的性能
